import{r as t,a as s,C as z,j as e,R as u,c as f,B as n,v as H,S as F,F as p,w as $,x as B,q as G}from"./index-33c4326b.js";import{I as O,D as V}from"./cjs-dc172a1a.js";import{F as W}from"./Form-6f9cfe9b.js";import{A as J}from"./Alert-bdb5bcdb.js";import{C as d}from"./Card-ce2b2b94.js";import{M as o}from"./Modal-25cb2c97.js";import"./clsx-9eb2d624.js";const K=c=>e(V,{handle:".modal-header",children:e(o.Dialog,{...c})}),se=()=>{const[c,M]=t.useState([]),[l,T]=t.useState(""),[b,j]=t.useState(1),[k,E]=t.useState(0),[i,g]=t.useState(!0),[N,x]=t.useState(!1),[A,v]=t.useState(!1),[h,S]=t.useState(null),[y,C]=t.useState(""),w=(a=1,L="")=>{a===1?g(!0):x(!0),fetch(`http://localhost:3001/api/content/books?page=${a}&limit=20`).then(r=>r.json()).then(r=>{console.log("Data received in LibrosPDF:",r),M(U=>a===1?r.data||[]:[...U,...r.data||[]]),E(r.total||0),j(a)}).catch(r=>{console.error("Error fetching books:",r)}).finally(()=>{g(!1),x(!1)})};t.useEffect(()=>{w(1,l)},[l]);const I=()=>{w(b+1,l)},q=a=>{T(a.target.value)},R=(a,L)=>{S(a),C(L),v(!0)},P=()=>{v(!1),S(null),C("")},D=a=>a.startsWith("/pdfs/")?a:`/pdfs/${a}`,m=(c||[]).filter(a=>a.title.toLowerCase().includes(l.toLowerCase())||a.author.toLowerCase().includes(l.toLowerCase()));return console.log("LibrosPDF rendering. State:",{books:c,searchTerm:l,filteredBooks:m,loading:i}),s(z,{className:"my-5",children:[e("title",{children:"Libros PDF - Vino Nuevo en Odres Nuevo"}),e(u,{className:"mb-5",children:e(f,{children:s("div",{className:"libros-hero-section",children:[e("h1",{className:"fw-bold fs-3 fs-sm-2 fs-md-1",children:"Biblioteca de Libros"}),e("p",{className:"px-4 fs-6 fs-sm-5",children:"Explora nuestra colección de libros en formato PDF."}),e("div",{className:"mt-4",children:e("a",{href:"/libros-pdf",className:"btn btn-light btn-sm",children:"¡Descubre Sabiduría Divina!"})}),e("p",{className:"mt-3 fs-6 fs-sm-5 text-shadow-sm",children:'"La lectura enriquece el alma y fortalece el espíritu."'})]})})}),e(u,{className:"justify-content-center mb-4 search-bar-section",children:s(f,{md:8,lg:6,children:[e("p",{className:"text-center lead text-muted mb-3",children:'"Encuentra tesoros de conocimiento y fe para alimentar tu caminar cristiano."'}),s(O,{children:[e(W.Control,{type:"text",placeholder:"Buscar por título o autor...",value:l,onChange:q,disabled:i}),s(n,{variant:"primary",disabled:i,className:"btn-sm",children:[e(H,{className:"me-1"})," Buscar"]})]})]})}),i&&b===1&&s("div",{className:"text-center my-4",children:[e(F,{animation:"border",variant:"primary"}),e("p",{className:"mt-2",children:"Cargando libros..."})]}),!i&&m.length===0&&e(J,{variant:"info",className:"text-center",children:"No se encontraron libros con el término de búsqueda."}),m.length>0&&s(p,{children:[e(u,{xs:1,md:2,lg:3,className:"g-4",children:m.map(a=>s(f,{children:[" ",s(d,{className:"h-100 shadow text-center card-book",children:[e(d.Body,{className:"d-flex flex-column justify-content-between p-4",children:s("div",{className:"mb-3",children:[a.coverImage?e("img",{src:a.coverImage,alt:a.title,className:"book-cover-image mb-3"}):e("div",{className:"book-placeholder mb-3 d-flex align-items-center justify-content-center",children:e("span",{className:"h5 fw-bold text-light",children:"Libro"})}),e(d.Title,{className:"h5 fw-bold",children:a.title}),a.author&&a.author!=="Autor Desconocido"&&s(d.Subtitle,{className:"text-muted small",children:["Por ",a.author]})]})}),s(d.Footer,{className:"d-grid gap-2 d-md-block",children:[" ",s(n,{variant:"primary",className:"rounded-pill me-md-2 mb-2 mb-md-0 btn-sm",onClick:()=>R(D(a.filename),a.title),children:[e($,{className:"me-1"})," Leer en Línea"]}),s(n,{as:"a",href:D(a.filename),download:!0,variant:"outline-secondary",className:"rounded-pill btn-sm",children:[e(B,{className:"me-1"})," Descargar"]})]})]})]},a.filename))}),e("p",{className:"text-center mt-5 lead text-muted",children:'"Sigue explorando nuestra biblioteca para nutrir tu mente y espíritu con la Palabra."'}),c.length<k&&e("div",{className:"text-center mt-4",children:e(n,{onClick:I,variant:"outline-primary",className:"rounded-pill px-4 btn-sm",disabled:N,children:N?s(p,{children:[e(F,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"}),"Cargando..."]}):s(p,{children:[e(G,{className:"me-2"}),"Cargar Más Libros"]})})})]}),h&&s(o,{show:A,onHide:P,dialogAs:K,centered:!0,size:"xl",dialogClassName:"draggable-pdf-modal",children:[e(o.Header,{closeButton:!0,className:"modal-header",children:e(o.Title,{children:y})}),e(o.Body,{className:"p-0",style:{height:"70vh"},children:e("iframe",{src:h,width:"100%",height:"100%",style:{border:"none"},title:y})}),s(o.Footer,{children:[s(n,{as:"a",href:h,download:!0,variant:"primary",className:"rounded-pill btn-sm",children:[e(B,{className:"me-1"})," Descargar PDF"]}),e(n,{variant:"secondary",onClick:P,className:"rounded-pill btn-sm",children:"Cerrar"})]})]})]})};export{se as default};
