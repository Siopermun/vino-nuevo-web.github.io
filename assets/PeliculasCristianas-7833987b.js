import{r,a as t,C as te,j as e,R as x,c as y,B as h,v as se,S as v,F as c,q as R}from"./index-33c4326b.js";import{I as re,D as le}from"./cjs-dc172a1a.js";import{u as ne}from"./usePageTitle-560252fa.js";import{F as q}from"./Form-6f9cfe9b.js";import{M as p}from"./Modal-25cb2c97.js";import{C as l}from"./Card-ce2b2b94.js";import{A}from"./Alert-bdb5bcdb.js";import"./clsx-9eb2d624.js";const ie=i=>e(le,{handle:".modal-header",children:e(p.Dialog,{...i})}),ge=()=>{ne("Películas Cristianas - Vino Nuevo en Odres Nuevo");const[i,z]=r.useState([]),[b,M]=r.useState([]),[C,T]=r.useState(!0),[d,w]=r.useState(!1),[P,H]=r.useState(null),[L,k]=r.useState(!1),[V,I]=r.useState(null),[E,D]=r.useState(""),[Y,B]=r.useState(null),[f,F]=r.useState(!1),[g,O]=r.useState("películas cristianas completas"),[G,J]=r.useState(1),[K,Q]=r.useState(0),U=(a=1)=>{a===1&&T(!0),fetch(`http://localhost:3001/api/content/movies?page=${a}&limit=6`).then(s=>s.json()).then(s=>{z(n=>a===1?s.data||[]:[...n,...s.data||[]]),Q(s.total||0),J(a)}).catch(s=>{console.error("Error fetching curated movies:",s)}).finally(()=>{T(!1)})};r.useEffect(()=>{U(1)},[]);const S=async(a,s=null,n=!1)=>{let $=`http://localhost:3001/api/youtube-search?query=${encodeURIComponent(a)}&maxResults=12`;s&&($+=`&pageToken=${s}`);try{n?(w(!0),M([]),B(null)):s?F(!0):w(!0);const o=await fetch($);if(!o.ok){const u=await o.json();throw new Error(u.error.error||u.error||"Error al conectar con el servidor backend.")}const j=await o.json();M(u=>{const ee=new Set(u.map(m=>m.id.videoId)),ae=j.items.filter(m=>m.id&&m.id.videoId&&!ee.has(m.id.videoId));return[...u,...ae]}),B(j.nextPageToken||null)}catch(o){H(o.message),console.error("Error proxying YouTube API request:",o)}finally{w(!1),F(!1)}};r.useEffect(()=>{S(g,null,!0)},[]);const W=a=>{a.preventDefault(),S(g,null,!0)},N=(a,s)=>{I(a),D(s),k(!0)},X=()=>{k(!1),I(null),D("")},Z=()=>C?t("div",{className:"text-center my-4",children:[e(v,{animation:"border",variant:"primary"}),e("p",{className:"mt-2",children:"Cargando películas destacadas..."})]}):i.length===0?null:t(c,{children:[e("h2",{className:"text-center mb-4 mt-5",children:"Nuestras Películas Destacadas"}),e("p",{className:"text-center lead text-muted mb-4",children:'"Una selección cuidadosamente elegida para edificar tu fe y la de tu hogar."'}),e(x,{xs:1,md:2,lg:3,className:"g-4 mb-5",children:i&&i.map((a,s)=>e(y,{children:t(l,{className:"h-100 shadow clickable-card card-book",onClick:()=>N(a.videoUrl,a.title),children:[e(l.Img,{variant:"top",src:a.imageUrl,alt:a.title,loading:"lazy"}),t(l.Body,{children:[e(l.Title,{className:"h6",children:a.title}),e(l.Text,{children:a.description})]}),e(l.Footer,{className:"d-grid",children:e(h,{variant:"primary",className:"rounded-pill btn-sm",onClick:n=>{n.stopPropagation(),N(a.videoUrl,a.title)},children:"Ver Película"})})]})},a.id||s))}),i.length<K&&e("div",{className:"text-center mt-4",children:e(h,{variant:"outline-primary",onClick:()=>U(G+1),disabled:C,className:"rounded-pill px-4 btn-sm",children:C?t(c,{children:[e(v,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true",className:"me-2"}),"Cargando Más..."]}):t(c,{children:[e(R,{className:"me-2"}),"Cargar Más Películas Destacadas"]})})})]}),_=()=>d&&b.length===0?t("div",{className:"text-center",children:[e(v,{animation:"border",variant:"primary"}),e("p",{className:"mt-2",children:"Buscando en YouTube..."})]}):P?t(A,{variant:"danger",children:["Error: ",P]}):b.length===0&&!d?e(A,{variant:"info",children:"No se encontraron videos de YouTube con la búsqueda actual."}):t(c,{children:[e("h2",{id:"mas-peliculas",className:"text-center mb-4 mt-5",children:"Más Películas"}),e("p",{className:"text-center lead text-muted mb-4",children:'"Explora aún más contenido inspirador y de fe directamente desde YouTube."'}),e(x,{xs:1,md:2,lg:3,className:"g-4",children:b&&b.map((a,s)=>e(y,{children:t(l,{className:"h-100 shadow clickable-card card-book",onClick:()=>N(`https://www.youtube.com/embed/${a.id.videoId}`,a.snippet.title),children:[e(l.Img,{variant:"top",src:a.snippet.thumbnails.medium.url,alt:a.snippet.title,loading:"lazy"}),e(l.Body,{children:e(l.Title,{className:"h6",children:a.snippet.title})}),e(l.Footer,{className:"d-grid",children:e(h,{variant:"primary",className:"rounded-pill btn-sm",onClick:n=>{n.stopPropagation(),N(`https://www.youtube.com/embed/${a.id.videoId}`,a.snippet.title)},children:"Ver Video"})})]})},`${a.id.videoId}-${s}`))}),Y&&e("div",{className:"text-center mt-4",children:e(h,{variant:"outline-primary",onClick:()=>S(g,Y),disabled:f||d,className:"rounded-pill px-4 btn-sm",children:f?t(c,{children:[e(v,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true",className:"me-2"}),"Cargando Más..."]}):t(c,{children:[e(R,{className:"me-2"}),"Cargar Más de YouTube"]})})})]});return t(te,{className:"my-5",children:[e("title",{children:"Películas Cristianas - Vino Nuevo en Odres Nuevo"}),e(x,{className:"mb-5",children:e(y,{children:t("div",{className:"peliculas-hero-section",children:[e("h1",{className:"fw-bold fs-3 fs-sm-2 fs-md-1",children:"Películas Cristianas"}),e("p",{className:"px-4 fs-6 fs-sm-5",children:"Disfruta de nuestra selección de películas y videos cristianos."}),e("div",{className:"mt-4",children:e("a",{href:"#mas-peliculas",className:"btn btn-light btn-sm",children:"¡Explora el Cine Cristiano!"})}),e("p",{className:"mt-3 fs-6 fs-sm-5 text-shadow-sm",children:'"Historias de fe que inspiran y transforman vidas."'})]})})}),e(x,{className:"justify-content-center mb-4 search-bar-section",children:t(y,{md:8,lg:6,children:[e("p",{className:"text-center lead text-muted mb-3",children:'"Encuentra la película cristiana perfecta para ti y tu familia."'}),e(q,{onSubmit:W,children:t(re,{children:[e(q.Control,{type:"text",placeholder:"Buscar películas o videos en YouTube...",value:g,onChange:a=>O(a.target.value),disabled:d||f}),t(h,{type:"submit",variant:"primary",disabled:d||f,className:"btn-sm",children:[e(se,{className:"me-1"})," Buscar"]})]})})]})}),Z(),_(),V&&t(p,{show:L,onHide:X,dialogAs:ie,centered:!0,dialogClassName:"draggable-video-modal",children:[t(p.Header,{closeButton:!0,className:"modal-header",children:[e(p.Title,{children:E}),"."]}),e(p.Body,{className:"p-0",children:e("div",{className:"embed-responsive embed-responsive-16by9",onMouseDown:a=>a.stopPropagation(),children:e("iframe",{className:"embed-responsive-item",src:V,allow:"autoplay; encrypted-media",allowFullScreen:!0,title:E,width:"100%",height:"400px"})})})]})]})};export{ge as default};
